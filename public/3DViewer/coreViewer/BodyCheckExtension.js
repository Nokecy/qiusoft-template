!function(){"use strict";class e{constructor(e){this.__meshstate__=e}getMeshMaterial(e){return this.__meshstate__.getMeshMaterial(e)}setMeshMaterial(e,t){this.__meshstate__.setMeshMaterial(e,t)}setMeshMaterialTemporary(e,t){let i=this.__meshstate__.meshMtls.get(e);if(i){let e=i.material;i.material=t,this.__meshstate__.__updateMeshMtlBuffer(i.meshMtlIndex,i),this.__meshstate__.meshMtlTexture.needsUpdate=!0,i.material=e,i.meshSet.needsUpdate=!0,i.meshSet.prepareForBatchDraw()}}getLineMaterial(e){return this.__meshstate__.getLineMaterial(e)}setLineMaterial(e,t,i){this.__meshstate__.setLineMaterial(e,t,i)}setLineMaterialTemporary(e,t,i){let r=this.__meshstate__.lineMtls.get(e);if(r){let e=2*r.lineMtlIndex;this.__meshstate__.lineMtlBuffer[e]=t,this.__meshstate__.lineMtlBuffer[e+1]=Math.round(1e3*i),this.__meshstate__.lineMtlTexture.needsUpdate=!0}}}class t{constructor(e){this.__brepManager__=e}hasBrepInfo(){return this.__brepManager__.hasBrepInfo()}hasBrepFile(){return this.__brepManager__.hasBrepFile()}getBrepInfos(){return this.__brepManager__.brepInfos}}
/**
	 * @file 这是新迪轻量化引擎查看器插件框架代码，请不要修改此文件
	 * @copyright 新迪数字 2024
	 */class i{constructor(i){this.__ndsModel__=i,i.meshState&&(this.__meshState__=new e(i.meshState)),i.brepManager&&(this.__brepManager__=new t(i.brepManager))}get isMCAD3DModel(){return this.__ndsModel__.isMCAD3DModel}get isMCAD2DModel(){return this.__ndsModel__.isMCAD2DModel}get typeName(){return this.__ndsModel__.typeName}get ndsModelId(){return this.__ndsModel__.id}get numMesh(){}getMeshState(){return this.__meshState__}getBrepManager(){return this.__brepManager__}getPMIObject(){return this.__ndsModel__.pmiObject}getRootBodyNode(){return this.__ndsModel__.rootBodyNode}getBodyNode(e){return this.__ndsModel__.getBodyNode(e)}getLeafBodies(e){return this.__ndsModel__.getLeafBodies(e)}isSketchModel(){return!!this.__ndsModel__.sketchFileUrl}getLeafBodyNodes(){return this.__ndsModel__.wholeLeafBodyNodes}transparentizeBodies(e){this.__ndsModel__.transparentizeBodies(e)}isolateBodies(e){this.__ndsModel__.isolateBodies(e,NDSWebViewer.SETTING.bodyOpacity,NDSWebViewer.SETTING.lineOpacity)}clearTransparentBodies(){this.__ndsModel__.exitIsolate()}getMeshSets(){return this.__ndsModel__.getMeshSets()}changeObjectidTouuid(e){return this.__ndsModel__.objectidTouuid[e]}getMeshMaterial(e){if(!this.__ndsModel__)return null;let t=this.__ndsModel__.meshManager.materialId[e],i=this.__ndsModel__.meshManager.materialUuids[t];return this.__ndsModel__.meshManager.materials[i].mat}setMeshMaterial(e,t){if(!this.__ndsModel__)return!1;let i=this.__ndsModel__,r=0;if(i.meshManager.materials[t.uuid]){for(let e=0;e<i.meshManager.materialUuids.length;e++)if(i.meshManager.materialUuids[e]===t.uuid){r=e;break}}else i.meshManager.materials[t.uuid]={mat:t,refCount:0},r=i.meshManager.materialUuids.length,i.meshManager.materialUuids.push(t.uuid);let s=i.meshManager.materialId[e],o=i.meshManager.materialUuids[s];return i.meshManager.materials[o].refCount--,i.meshManager.materials[t.uuid].refCount++,i.meshManager.materialId[e]=r,i.meshManager.materialIdOriginal[e]=r,!0}removeAllBodyNodeMaterials(){this.__ndsModel__.removeAllBodyNodeMaterials()}removeBodyNodeMaterial(e){this.__ndsModel__.removeBodyNodeMaterial(e)}refreshBodyWorldMatrixUniforms(){this.__ndsModel__.refreshBodyWorldMatrixUniforms()}refreshMeshState(e=void 0){this.__ndsModel__.refreshMeshState(e||this.__ndsModel__.rootBodyNode)}}
/**
	 * @file 这是新迪轻量化引擎查看器插件框架代码，请不要修改此文件
	 * @copyright 新迪数字 2024
	 */console.log("NDS ExtensionFramework V0.1");const r={FLAG_ENABLE_NODE_TRANSFORM:NDSWebViewer.Extension.FLAG_ENABLE_NODE_TRANSFORM,FLAG_ENABLE_NODE_STOREVIEW:NDSWebViewer.Extension.FLAG_ENABLE_NODE_TRANSFORM<<1,FLAG_ENABLE_NODE_CAMERA2D:NDSWebViewer.Extension.FLAG_ENABLE_NODE_TRANSFORM<<2,FLAG_ENABLE_NODE_BLOCK:NDSWebViewer.Extension.FLAG_ENABLE_NODE_TRANSFORM<<3,FLAG_ENABLE_NODE_TEXT:NDSWebViewer.Extension.FLAG_ENABLE_NODE_TRANSFORM<<4};class s extends NDSWebViewer.Extension{constructor(){super()}onLoad(e){}onInitLights(){}update(e){}setFlags(e){super.setFlags(e)}onNdsModelPrepareForRendering(e){}onBeforeNdsModelUpdate(e,t){}onAfterNdsModelUpdate(e,t){}onBeforeNdsModelSetRender(e,t){}onAfterNdsModelSetRender(e,t){}onBeforeNdsMeshRender(e,t){}getExtensionWithFlags(e){return NDSWebViewer.ExtensionManager.getExtensionWithFlags(e)}resetToDefault(){}getStoreInfo(e){throw this.name+" Extesion did not implement method 'getStoreInfo' "}setStoreInfo(e){throw this.name+" Extesion did not implement method 'setStoreInfo' "}getBodyTransform(e){return new THREE.Matrix4}getBodyNodeTranslate(e){return new THREE.Vector3(0,0,0)}}
/**
	 * @file 这是新迪轻量化引擎查看器插件框架代码，请不要修改此文件
	 * @copyright 新迪数字 2024
	 */class o{static getModel(e){return e.ndsModel}static getModelId(e){return e.ndsModel.id}static getUUID(e){return e.uuid}static getObjectId(e){return e.objectid}static getId(e){return e.id}static getBodyNodeMaterial(e){let t=e.getMaterialBodyNodeUUid();return t&&e.useBodyNodeMaterial?e.ndsModel.bodyNodeUUidToMaterial[t]:null}static setBodyNodeMaterial(e,t){e.ndsModel.bodyNodeUUidToMaterial[e.uuid]=t,e.useBodyNodeMaterial=!!t}static getUserMaterial(e){return e.getUserMaterial()}static setUserMaterial(e,t){e.setUserMaterial(t)}static getBoundingBox(e){var t=new THREE.Box3;return e.getBoundingBox(t,!0)}static isLeafBodyNode(e){return!!e.leafBodyAttri}static isPartBodyNode(e){return"Part"===e.type}static getLeafBodyNodes(e){return e.ndsModel.getLeafBodies(e)}static getMeshesInLeafBodyNode(e){return e.leafBodyAttri?e.leafBodyAttri.bodyMeshIds:[]}static getMatrixLocal(e){return e.matrix}static getMatrixWorld(e){return e.worldMatrix}static setMatrixWorld(e,t){e.setMatrixWorld(t)}static applyTransform(e,t=null){e.applyTransform(t)}static updateMatrixWorld(e,t=!1){e.updateMatrixWorld(t,!0)}static hide(e){e.hide(e)}static show(e){e.show()}static isPreSelected(e){return e.isPreSelected()}static isSelected(e){return e.isSelected()}static isTransparent(e){return e.isTransparent()}static isHidden(e){return e.isHidden()}static isIsolated(e){return e.isIsolated()}static getRenderMode(e){switch(e.renderMode){case 3:return"wireframe";case 4:return"hiddenLineRemove";case 5:return"hiddenLineVisible"}return""}static getBodyNodeTranslate(e,t){let i=new THREE.Vector3(0,0,0),s=e.getExtensionWithFlags(r.FLAG_ENABLE_NODE_TRANSFORM);for(let e=0,r=s.length;e<r;++e)i.add(s[e].getBodyNodeTranslate(t));return i}static updateNodeMatrix(e,t){e.ndsModel.updateNodeMatrix(e.uuid,t,e.getModel().id)}static hideBody(e){e.ndsModel.hideBody(e)}static showBody(e){e.ndsModel.showBody(e)}}
/**
	 * @file 这是新迪轻量化引擎查看器插件框架代码，请不要修改此文件
	 * @copyright 新迪数字 2024
	 */class n{constructor(e){this.__coreView__=e}addEventListener(e,t){this.__coreView__.addEventListener(e,t)}hasEventListener(e,t){return this.__coreView__.hasEventListener(e,t)}removeEventListener(e,t){this.__coreView__.removeEventListener(e,t)}dispatchEvent(e){this.__coreView__.dispatchEvent(e)}getPixelRatio(){return this.__coreView__.renderer.getPixelRatio()}switchRotateCenterBySelection(){this.__coreView__.switchRotateCenterBySelection()}setDefaultEnvMap(e){e&&(this.__coreView__.hasPbrMaterial=!0,this.__coreView__.setDefaultEnvMap=()=>{this.__coreView__.setEnvMapEnabled(!0),this.__coreView__.defaultEnvMapTexture=e,this.__coreView__.updateEnvMap(this.__coreView__.defaultEnvMapTexture)},this.__coreView__.setDefaultEnvMap())}getBackgroundState(){return this.__coreView__.exchangeBackImage?{type:this.__coreView__.exchangeBackImage.type,value:this.__coreView__.exchangeBackImage.value}:void 0}setBackgroundState(e,t){"Image"===e?(this.__coreView__.setEnvMapTextures(null),this.__coreView__.setBackGroundImage(t)):"EnvMap"===e?this.__coreView__.setEnvMapTextures(t):"Color"===e&&(this.__coreView__.setEnvMapTextures(null),this.__coreView__.setBackGroundImage(null),this.__coreView__.setBackGroundColor(t))}removeAllLights(){this.__coreView__.lights.length=0}getLight(e){return this.__coreView__.lights[e]}setLight(e,t){this.__coreView__.lights[e]=t}getViewBox(){return this.__coreView__.viewBox}toggleAutoRotation(e){this.__coreView__.toggleAutoRotation(e)}randColor(){return this.__coreView__.materialsSetting.randColor()}getBoundingBox(e=!1){let t=this.__coreView__.ndsModel.getTotalBodyBoundingBox(null,e);return t.isEmpty()?this.__coreView__.modelRootObject.boundingBox:t}getModelTree(){return this.__coreView__.getModelTree()}getModelCount(){return this.__coreView__.ndsModel.models.length}setActiveModel(e){this.__coreView__.ndsModel.setActiveModel(e)}setActiveModelByModelId(e){let t=-1;for(let i=0;i<this.__coreView__.ndsModel.models.length;++i)if(this.__coreView__.ndsModel.models[i].id===e){t=i;break}this.setActiveModel(t)}getActiveModel(){return this.__coreView__.ndsModel.getActiveModel()}getModelById(e){return this.__coreView__.ndsModel.getModelById(e)}getModelByIndex(e){return this.__coreView__.ndsModel.models[e]}registOperator(e,t){this.__coreView__.registOperator(e,t)}setOperatorByID(e){this.__coreView__.setOperatorByID(e)}getCurrentOperator(){return this.__coreView__.controls.getOperator()}getCurrentOperatorID(){return this.__coreView__.getCurrentOperatorID()}setOperator(e){this.__coreView__.setOperator(e)}registCursor(e,t,i){this.__coreView__.registCursor(e,t,i)}hideSelectedObjects(){this.__coreView__.hideSelectedObjects()}getViewControlBoundingBox(){return this.__coreView__.controls.getBoundingBox()}setViewControlBoundingBox(e,t){this.__coreView__.controls.setBoundingBox(e,t)}getCamera(){return this.__coreView__.camera}setCameraControlBoundingBoxCenter(e){this.__coreView__.cameraControl.setBoundingBoxCenter(e)}setCameraControlBounding(e,t){this.__coreView__.cameraControl.setBoundingBox(e,t)}getRotateCenter(){return this.__coreView__.cameraControl.getRotateCenter()}setRotateCenter(e){this.__coreView__.cameraControl.setRotateCenter(e)}getViewLockedState(){return this.__coreView__.cameraControl.isViewLockedBySingleBody}setViewLockedState(e){this.__coreView__.cameraControl.isViewLockedBySingleBody=e}getCameraInfo(){return this.__coreView__.cameraControl.getCameraInfo()}adjustNearAndFar(){this.__coreView__.cameraControl.adjustNearAndFar()}updateViewBoxCamDir(){this.__coreView__.cameraControl.updateViewBoxCamDir()}startSmoothTranslation(e){this.__coreView__.cameraControl.startSmoothTranslation(e)}zoomExtents(e,t,i){this.__coreView__.cameraControl.zoomExtents(e,t,i)}setCameraInfo(e,t){this.__coreView__.cameraControl.setCameraInfo(e,t)}getOrginalCameraInfo(){return this.__coreView__.viewManager?this.__coreView__.viewManager.getOrginalCameraInfo():this.__coreView__.camera.getOrginalCameraInfo()}setOrginalCameraInfo(e,t,i){this.__coreView__.camera.setOrginalCameraInfo({center:e,up:t,position:i})}toPerspectiveCamera(){this.__coreView__.toPerspectiveCamera()}toOrthographicCamera(){this.__coreView__.toOrthographicCamera()}updateGroundTransform(e,t,i){return this.__coreView__.groundShadow.updateGroundTransform(e,t,i)}isRendererContainsClipPlanes(){return this.__coreView__.renderer.clippingPlanes.length>0}getCanvas2D(){return this.__coreView__.canvas2D}getCanvas3D(){return this.__coreView__.canvas3D}getContainer(){return this.__coreView__.container}getRenderDomElement(){return this.__coreView__.renderer.domElement}getAdditionalObjectsScene(){return this.__coreView__.additionalObjectsScene}getDispalyModelUnit(e,t){return this.__coreView__.getDispalyModelUnit(e,t)}modelCoordToClientCoord(e){return this.__coreView__.modelCoordToClientCoord(e)}clientCoordToModelCoord(e){return this.__coreView__.clientCoordToModelCoord(e)}showObject(e,t,i,r=!0){this.__coreView__.showObject(e,t,i,r)}showObjectReversed(e){this.__coreView__.showObjectReversed(e)}renderAllViews(){this.__coreView__.renderAllViews()}render(e){this.__coreView__.render(e)}setRenderMode(e,t){this.__coreView__.setRenderMode(e,t)}getRenderMode(){let e;switch(this.__coreView__.getRenderMode()){case 0:e="lighting";break;case 1:e="primarycolor";break;case 2:e="wireframe";break;case 3:e="whitemold";break;case 4:e="shadedWithEdges";break;case 5:e="shaded";break;case 6:e="hiddenLineRemove";break;case 7:e="hiddenLineVisible";break;case 8:e="transparent"}return e}getAssemblyPMIState(){return this.__coreView__.AssemblyPMIState}setAssemblyPMIState(e){this.__coreView__.AssemblyPMIState=e}getPartPMIState(){return this.__coreView__.PartPMIState}setPartPMIState(e){this.__coreView__.PartPMIState=e}getPmiVisible(){return this.__coreView__.pmiVisible}setPmiVisible(e){this.__coreView__.pmiVisible=e}setPMIObjectVisible(e,t){this.__coreView__.setPMIObjectVisible(e,t)}isPMIOccludeByModel(){return!NDSWebViewer.SETTING.StopPMIOcclusion}enablePMIOccludeByModel(e){this.__coreView__.stopPMIOcclusion(!e)}getPmiList(){return this.__coreView__.PMINDSBodys}getPMIObjectByUUID(e){return this.__coreView__.PMIUUIDtoPMIObject[e]}isPMIObjectOrSomeChildHidden(e){return this.__coreView__.isPMIObjectOrSomeChildHidden(e)}getPmiObjectTree(){return this.__coreView__.pmiObject}getSelectedPmiList(){return this.__coreView__.getPMINDSBodySelectList()}selectPMIObject(e){this.__coreView__.selectPMIObject(e)}deselectPMIObject(e){this.__coreView__.deselectPMIObject(e)}unmergeBodyNode(){this.__coreView__.ndsModel.unmergeNode()}mergeBodyNode(){this.__coreView__.ndsModel.mergeNode()}getAllTransparentBodies(e){return this.__coreView__.ndsModel.getAllTransparentBodies(e)}isolateBodiesOnly(e){this.__coreView__.ndsModel.isolateBodiesOnly(e)}unloadModelById(e){this.__coreView__.ndsModel.unloadModelById(e)}startLoadAnimationModel(e){let t=e.url,i=e.id,r={needsPMI:!1,needsAnimation:!1,needsSketchModel:!1,position:e.position,pmiVisible:this.__coreView__.pmiVisible,modelId:e.modelId};this.__coreView__.loadModel(i,t,null,null,"js",null,null,null,r)}getBodyNodeFromUuid(e,t=-1){var i=null;if(t>=0){let r=this.getModelById(t);if(r){let t=r.getBodyNodeFromUuid(e);t&&(i=t)}}else this.__coreView__.ndsModel.models.forEach((t=>{let r=t.getBodyNodeFromUuid(e);r&&(i=r)}));return i}loadBrepInfo(e){this.__coreView__.loadBrepInfo(e)}}class d{constructor(e){this.__selectionManager__=e.selectionManager}getSelectedObjects(){return this.__selectionManager__.getSelectedObjects()}getSelectedMeshes(){return this.__selectionManager__.getSelectedMeshes()}clearSelection(){this.__selectionManager__.clearSelection()}setSelectType(e){this.__selectionManager__.setSelectType(e)}selectByClick(e,t){this.__selectionManager__.selectByClick(e,t)}}"undefined"!=typeof token&&token;const _=new class extends s{constructor(){super(),this.setFlags(r.FLAG_ENABLE_NODE_STOREVIEW),this.name="BodyCheckExtension",console.log("BodyCheckExtension version 1.0.3"),this.checkVisibleList=new Map,this.storeInfo=null}onLoad(e){this.sceneWraper=new n(e),this.selectionManager=new d(e),this.coreView=e}hideOtherObjectsfrombody(e){let t=this.sceneWraper.getActiveModel();t.hideAllBodies(),t.showBody(e);var i=this.sceneWraper.getCurrentOperator();i&&i.updateViewCenterByVisibleBody()}resetToDefaultState(){let e=this.sceneWraper.getActiveModel().id;for(const[t,i]of this.checkVisibleList.entries()){let r=this.sceneWraper.getBodyNodeFromUuid(t,e),s=r.children[i.originFirstVisibleNode];r.FirstVisibleNode=i.originFirstVisibleNode;for(let e=0;e<r.children.length;e++){let t=r.children[e];t.checkVisible=t.originalCheckVisible,t.unload=!t.checkVisible,s.uuid===t.uuid?(t.IsMergedNode=!1,t.leafBodyAttri&&(t.leafBodyAttri.totalMeshIds=null,t.leafBodyAttri.totalLineSegIds=null,t.leafBodyAttri.updateBoundingBox(),t.__setBoundingBoxDirty__())):(t.IsMergedNode=!0,t.responsNode=s)}}this.checkVisibleList.clear()}onNdsModelPrepareForRendering(e){if(e.rootBodyNode){var t=[e.rootBodyNode];for(let e=0;e<t.length;++e){let i=t[e],r=i.type.toLowerCase(),s=i.name.split(".")[0];i.children&&i.children[0]&&s===i.children[0].name&&(i.VirtualNode=i.children[0],i.children[0].isVirtualNode=!0),"body"===r&&(i.checkVisible=i.visible,i.originalCheckVisible=i.checkVisible);for(let e=0,r=i.children.length;e<r;++e)t.push(i.children[e])}}}enterBody(e){let t=NDSWebViewer.ExtensionManager.getExtension("StoreViewExtension"),i=this.sceneWraper.getBodyNodeFromUuid(e.uuid,e.ndsModel.id);if("part"===i.type.toLowerCase()&&i.children.length>0&&"body"===i.children[0].type.toLowerCase()){this.storeInfo=t.getModelViewInfo(),this.storeInfo.bodyCheckInfo=null,this.selectionManager.clearSelection();for(let t=0;t<i.children.length;t++){let r=i.children[t];!0!==r.unload||e.ndsModel.unvisibleList&&-1!==e.ndsModel.unvisibleList.indexOf(r.objectid)||(r.unload=!1)}return e.ndsModel.unmergeNode(),this.hideOtherObjectsfrombody(i),this.selectionManager.setSelectType("body"),NDSWebViewer.SETTING.enableSelect=!1,this.coreView.setSelectBodyByRect(!1),this.sceneWraper.renderAllViews(),i.children}return"assembly"===i.type.toLowerCase()&&i.VirtualNode?this.enterBody(i.VirtualNode):[]}exitBody(e){let t=NDSWebViewer.ExtensionManager.getExtension("StoreViewExtension"),r=this.sceneWraper.getBodyNodeFromUuid(e.uuid,e.ndsModel.id);if("part"===r.type.toLowerCase()&&r.children.length>0&&"body"===r.children[0].type.toLowerCase()){this.selectionManager.clearSelection();let s=this.sceneWraper.getActiveModel(),o=r.FirstVisibleNode?r.FirstVisibleNode:0;this.checkVisibleList.has(r.uuid)||this.checkVisibleList.set(r.uuid,{originFirstVisibleNode:o});let n=null;if(r.children[o].checkVisible&&(n=r.children[o]),!n)for(let a=0;a<r.children.length;a++){let l=r.children[a];if(l.checkVisible){n=l,r.FirstVisibleNode=a;break}}let d=[];for(let c=0;c<r.children.length;c++){let h=r.children[c];function u(e,t){for(let i=0;i<e.length;i++)if(e[i].uuid===t)return i;return-1}h.unload=!h.checkVisible,n&&h.uuid===n.uuid?(h.IsMergedNode=!1,h.leafBodyAttri&&(h.leafBodyAttri.totalMeshIds=null,h.leafBodyAttri.totalLineSegIds=null,h.leafBodyAttri.updateBoundingBox(),h.__setBoundingBoxDirty__())):(h.IsMergedNode=!0,h.responsNode=n);let g=u(s.UnloadNodes,h.uuid);h.checkVisible?-1!==g&&s.UnloadNodes.splice(g,1):(d.push(h.uuid),-1===g&&s.UnloadNodes.push(h))}let _=this.checkVisibleList.get(r.uuid);if(_.unloadNode=d,_.FirstVisibleNode=r.FirstVisibleNode,r.ndsModel.mergeNode(),this.selectionManager.setSelectType("part"),this.storeInfo){let M=this.sceneWraper.getActiveModel(),V=new i(M),m=function(e){if(e)for(let t=0;t<e.length;t++){V.getBodyNode(e[t]).parent.uuid===r.uuid&&(e[t]=r.children[r.FirstVisibleNode].id)}},w=this.storeInfo.modelStates.find((e=>e.id===r.ndsModel.id));w&&(m(w.meshVisible),m(w.meshTrans),m(w.meshInvisible),m(w.meshNoTrans)),t.setModelViewInfo(this.storeInfo)}return NDSWebViewer.SETTING.enableSelect=!0,this.coreView.setSelectBodyByRect(!0),r.children}if("assembly"===r.type.toLowerCase()&&r.VirtualNode)return this.exitBody(r.VirtualNode)}showBody(e){if("body"!==e.type.toLowerCase())return;let t=this.sceneWraper.getBodyNodeFromUuid(e.uuid,e.ndsModel.id);t.checkVisible=!0,o.showBody(t)}hideBody(e){if("body"!==e.type.toLowerCase())return;let t=this.sceneWraper.getBodyNodeFromUuid(e.uuid,e.ndsModel.id);t.checkVisible=!1,o.hideBody(t)}getStoreInfo(e){e.bodyCheckInfo=this.getCheckVisibleList()}setStoreInfo(e){if(!e.bodyCheckInfo)return;this.resetToDefaultState();let t=JSON.parse(JSON.stringify(e.bodyCheckInfo));this.checkVisibleList=new Map(Object.entries(t));let i=this.sceneWraper.getActiveModel().id;for(const[e,t]of this.checkVisibleList.entries()){let r=this.sceneWraper.getBodyNodeFromUuid(e,i),s=r.children[t.FirstVisibleNode];r.FirstVisibleNode=t.FirstVisibleNode;for(let e=0;e<r.children.length;e++){let i=r.children[e];i.checkVisible=!0,-1!=t.unloadNode.indexOf(i.uuid)&&(i.checkVisible=!1),i.unload=!i.checkVisible,s.uuid===i.uuid?(i.IsMergedNode=!1,i.leafBodyAttri&&(i.leafBodyAttri.totalMeshIds=null,i.leafBodyAttri.totalLineSegIds=null,i.leafBodyAttri.updateBoundingBox(),i.__setBoundingBoxDirty__())):(i.IsMergedNode=!0,i.responsNode=s)}}}getCheckVisibleList(){let e=Object.fromEntries(this.checkVisibleList);return JSON.parse(JSON.stringify(e))}isEmptyNode(e){let t=this.sceneWraper.getBodyNodeFromUuid(e.uuid,e.ndsModel.id);if(!t)return!1;if("part"===t.type.toLowerCase()&&t.children.length>0&&"body"===t.children[0].type.toLowerCase()){for(let e=0;e<t.children.length;e++){if(!0!==t.children[e].unload)return!1}return!0}return!1}};NDSWebViewer.ExtensionManager.addExtension(_)}();
