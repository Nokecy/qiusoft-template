!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.RBush=e():t.RBush=e()}(window,function(){return i=[function(t,e,i){i.r(e),i.d(e,"RBush",function(){return n});class n{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(e){let i=this.data;var n=[];if(l(e,i))for(var r=this.toBBox,a=[];i;){for(let t=0;t<i.children.length;t++){var h=i.children[t],o=i.leaf?r(h):h;l(e,o)&&(i.leaf?n.push(h):c(e,o)?this._all(h,n):a.push(h))}i=a.pop()}return n}collides(e){let i=this.data;if(l(e,i))for(var n=[];i;){for(let t=0;t<i.children.length;t++){var r=i.children[t],a=i.leaf?this.toBBox(r):r;if(l(e,a)){if(i.leaf||c(e,a))return!0;n.push(r)}}i=n.pop()}return!1}load(e){if(e&&e.length)if(e.length<this._minEntries)for(let t=0;t<e.length;t++)this.insert(e[t]);else{let t=this._build(e.slice(),0,e.length-1,0);var i;this.data.children.length?this.data.height===t.height?this._splitRoot(this.data,t):(this.data.height<t.height&&(i=this.data,this.data=t,t=i),this._insert(t,this.data.height-t.height-1,!0)):this.data=t}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=p([]),this}remove(r,a){if(r){let t=this.data;var h=this.toBBox(r),o=[],l=[];let e,i,n;for(;t||o.length;){if(t||(t=o.pop(),i=o[o.length-1],e=l.pop(),n=!0),t.leaf){var s=function(e,i,n){if(!n)return i.indexOf(e);for(let t=0;t<i.length;t++)if(n(e,i[t]))return t;return-1}(r,t.children,a);if(-1!==s)return t.children.splice(s,1),o.push(t),this._condense(o),this}n||t.leaf||!c(t,h)?i?(e++,t=i.children[e],n=!1):t=null:(o.push(t),l.push(e),e=0,t=(i=t).children[0])}}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){for(var i=[];t;)(t.leaf?e:i).push(...t.children),t=i.pop();return e}_build(i,t,n,r){var e=n-t+1;let a=this._maxEntries,h;if(e<=a)u(h=p(i.slice(t,n+1)),this.toBBox);else{r||(r=Math.ceil(Math.log(e)/Math.log(a)),a=Math.ceil(e/Math.pow(a,r-1))),(h=p([])).leaf=!1,h.height=r;var o=Math.ceil(e/a),l=o*Math.ceil(Math.sqrt(a));g(i,t,n,l,this.compareMinX);for(let e=t;e<=n;e+=l){var s=Math.min(e+l-1,n);g(i,e,s,o,this.compareMinY);for(let t=e;t<=s;t+=o){var m=Math.min(t+o-1,s);h.children.push(this._build(i,t,m,r-1))}}u(h,this.toBBox)}return h}_chooseSubtree(r,a,t,h){for(;;){if(h.push(a),a.leaf||h.length-1===t)break;let e=1/0,i=1/0,n;for(let t=0;t<a.children.length;t++){var o=a.children[t],l=x(o),s=(m=r,s=o,(Math.max(s.maxX,m.maxX)-Math.min(s.minX,m.minX))*(Math.max(s.maxY,m.maxY)-Math.min(s.minY,m.minY))-l);s<i?(i=s,e=l<e?l:e,n=o):s===i&&l<e&&(e=l,n=o)}a=n||a.children[0]}var m,s;return a}_insert(t,e,i){var i=i?t:this.toBBox(t),n=[],r=this._chooseSubtree(i,this.data,e,n);for(r.children.push(t),m(r,i);0<=e&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(i,n,e)}_split(t,e){var i=t[e],n=i.children.length,r=this._minEntries,r=(this._chooseSplitAxis(i,r,n),this._chooseSplitIndex(i,r,n)),n=p(i.children.splice(r,i.children.length-r));n.height=i.height,n.leaf=i.leaf,u(i,this.toBBox),u(n,this.toBBox),e?t[e-1].children.push(n):this._splitRoot(i,n)}_splitRoot(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,u(this.data,this.toBBox)}_chooseSplitIndex(e,i,n){let r,a=1/0,h=1/0;for(let t=i;t<=n-i;t++){var o=d(e,0,t,this.toBBox),l=d(e,t,n,this.toBBox),s=(u=o,s=l,m=c=f=void 0,f=Math.max(u.minX,s.minX),c=Math.max(u.minY,s.minY),m=Math.min(u.maxX,s.maxX),u=Math.min(u.maxY,s.maxY),Math.max(0,m-f)*Math.max(0,u-c)),m=x(o)+x(l);s<a?(a=s,r=t,h=m<h?m:h):s===a&&m<h&&(h=m,r=t)}var u,s,f,c,m;return r||n-i}_chooseSplitAxis(t,e,i){var n=t.leaf?this.compareMinX:a,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)}_allDistMargin(e,i,n,t){e.children.sort(t);var r=this.toBBox,a=d(e,0,i,r),h=d(e,n-i,n,r);let o=f(a)+f(h);for(let t=i;t<n-i;t++){var l=e.children[t];m(a,e.leaf?r(l):l),o+=f(a)}for(let t=n-i-1;t>=i;t--){var s=e.children[t];m(h,e.leaf?r(s):s),o+=f(h)}return o}_adjustParentBBoxes(e,i,n){for(let t=n;0<=t;t--)m(i[t],e)}_condense(i){for(let t=i.length-1,e;0<=t;t--)0===i[t].children.length?0<t?(e=i[t-1].children).splice(e.indexOf(i[t]),1):this.clear():u(i[t],this.toBBox)}}function u(t,e){d(t,0,t.children.length,e,t)}function d(e,i,n,r,a){(a=a||p(null)).minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(let t=i;t<n;t++){var h=e.children[t];m(a,e.leaf?r(h):h)}return a}function m(t,e){t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY)}function a(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function x(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function c(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function l(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function M(i,n,r=0,a=i.length-1,h=(t,e)=>t<e?-1:e<t?1:0){for(var o=(t,e,i)=>{var n=t[e];t[e]=t[i],t[i]=n};r<a;){600<a-r&&(l=a-r+1,s=n-r+1,u=Math.log(l),m=.5*Math.exp(2*u/3),u=.5*Math.sqrt(u*m*(l-m)/l)*(s-l/2<0?-1:1),M(i,n,Math.max(r,Math.floor(n-s*m/l+u)),Math.min(a,Math.floor(n+(l-s)*m/l+u)),h));var l,s,m,u,f=i[n];let t=r,e=a;for(o(i,r,n),0<h(i[a],f)&&o(i,r,a);t<e;){for(o(i,t,e),t++,e--;h(i[t],f)<0;)t++;for(;0<h(i[e],f);)e--}0===h(i[r],f)?o(i,r,e):o(i,++e,a),e<=n&&(r=e+1),n<=e&&(a=e-1)}}function g(t,e,i,n,r){for(var a,h=[e,i];h.length;)(i=h.pop())-(e=h.pop())<=n||(M(t,a=e+Math.ceil((i-e)/n/2)*n,e,i,r),h.push(e,a,a,i))}}],n={},r.m=i,r.c=n,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0);function r(t){var e;return(n[t]||(e=n[t]={i:t,l:!1,exports:{}},i[t].call(e.exports,e,e.exports,r),e.l=!0,e)).exports}var i,n});