# BOM反查功能 UI设计文档 (Redesigned)

## 📋 文档信息

- **功能名称**: BOM反向查找（Where-Used Query）
- **功能编号**: PDM-BOM-005
- **版本**: v2.0 (Redesigned)
- **更新日期**: 2025-11-23
- **设计风格**: Modern Enterprise (2B) - Premium & Dynamic
- **适用端**: Web (Desktop First), Responsive Mobile

---

## 🎯 设计目标与理念

### 核心理念
打造**高效、直观、沉浸式**的BOM反查体验。摒弃传统ERP枯燥的表格堆砌，采用现代化的数据可视化与层级展示技术，让复杂的BOM结构一目了然。

### 设计原则
1.  **视觉层级分明**: 通过色彩、阴影和间距区分信息层级，让用户一眼抓住重点。
2.  **交互流畅自然**: 引入微交互（Micro-interactions）和过渡动画，提升操作愉悦感。
3.  **信息展示高效**: 提供多种视图（树状图、列表、卡片），满足不同场景下的分析需求。
4.  **专业与美感并重**: 使用和谐的配色和精细的排版，体现企业级应用的专业性。

---

## 🎨 视觉风格定义

### 1. 色彩体系 (Color Palette)
采用 **"深邃蓝"** 为主色调，搭配 **"活力青"** 作为强调色，营造科技感与专业感。

- **主色 (Primary)**: `#1890FF` (科技蓝) - 用于按钮、高亮、链接
- **次色 (Secondary)**: `#00B578` (活力青) - 用于成功状态、层级标识
- **强调色 (Accent)**: `#FAAD14` (琥珀黄) - 用于警告、重要提示
- **背景色 (Background)**: 
  - 页面背景: `#F0F2F5` (浅灰)
  - 卡片背景: `#FFFFFF` (纯白)
  - 悬浮层: `rgba(255, 255, 255, 0.8)` (毛玻璃效果)

### 2. 字体排版 (Typography)
使用系统默认字体栈，优先 `Inter`, `Roboto`, `PingFang SC`。

- **一级标题**: 20px, Bold, `#1F1F1F`
- **二级标题**: 16px, Medium, `#1F1F1F`
- **正文**: 14px, Regular, `#434343`
- **辅助文字**: 12px, Regular, `#8C8C8C`

### 3. 阴影与质感 (Shadow & Texture)
- **卡片阴影**: `box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08)`
- **悬浮阴影**: `box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12)`
- **圆角**: `border-radius: 8px` (统一圆角，柔和视觉)

---

## 🚀 页面布局与交互

### 1. 整体布局架构
采用 **"顶部搜索 + 侧边统计 + 主体内容"** 的布局结构。

```
┌──────────────────────────────────────────────────────────────────┐
│  [Logo]  BOM管理系统           [🔔] [👤]                        │
├──────────────────────────────────────────────────────────────────┤
│  BOM反向查找                                                     │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │  🔍 搜索栏: [ 请输入子项物料编码... ]  [ 查询 ] [ 高级筛选 ]   │  │
│  └────────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────┐  ┌──────────────────────────────────────────┐  │
│  │ 📊 概览卡片   │  │ 📂 查询结果                              │  │
│  │              │  │                                          │  │
│  │  直接父项    │  │  [视图切换: 🌳 树状 | 📋 列表]  [📥 导出]   │  │
│  │   [ 5 ]      │  │                                          │  │
│  │              │  │  ▼ Level 1: PARENT-001                   │  │
│  │  间接父项    │  │    ├─ 📦 版本: V1.0                      │  │
│  │   [ 12 ]     │  │    ├─ 📅 生效: 2024-01-01                │  │
│  │              │  │    └─ 🔢 用量: 2 PCS                     │  │
│  │  最大层级    │  │                                          │  │
│  │   [ 4 ]      │  │  ▼ Level 2: GRAND-PARENT-001             │  │
│  │              │  │    ├─ ...                                │  │
│  └──────────────┘  └──────────────────────────────────────────┘  │
└──────────────────────────────────────────────────────────────────┘
```

### 2. 交互流程 (User Flow)

1.  **进入页面**: 
    - 页面加载时，焦点自动定位到搜索框。
    - 显示空的初始状态插画（Empty State）。

2.  **执行查询**:
    - 用户输入物料编码（支持模糊匹配下拉）。
    - 点击查询或按回车。
    - **加载状态**: 搜索框显示 Loading 动画，结果区域显示骨架屏（Skeleton）。

3.  **查看结果**:
    - **树状视图**: 默认展开第一层级。用户点击节点可展开/折叠。
    - **详情查看**: 鼠标悬停在节点上，显示浮层（Popover）展示更多物料属性。
    - **跳转**: 点击物料编码，新标签页打开物料详情。

4.  **数据导出**:
    - 点击导出按钮，弹出格式选择（Excel/PDF）。
    - 导出完成后显示成功 Toast 提示。

---

## 🧩 详细组件设计

### 1. 智能搜索栏 (Smart Search Bar)
- **样式**: 大尺寸输入框，高度 48px，带阴影。
- **功能**:
  - **自动补全**: 输入 3 个字符后触发 API 搜索建议。
  - **历史记录**: 点击输入框显示最近查询的 5 个物料。
  - **扫码支持**: 右侧集成扫码图标，点击触发扫码枪输入模式。

### 2. 概览仪表盘 (Overview Dashboard)
位于左侧或顶部，使用卡片展示关键指标。
- **组件**: `StatisticCard`
- **内容**:
  - **直接引用**: 数字加粗，蓝色高亮。
  - **总引用数**: 数字加粗，绿色高亮。
  - **最深层级**: 数字加粗，橙色高亮。

### 3. 结果展示区 (Result Area)

#### A. 树状视图 (Tree View) - *推荐*
- **节点设计**: 卡片式节点，左侧带层级颜色条。
- **层级线**: 使用虚线连接父子节点，清晰展示归属关系。
- **内容**:
  - **标题**: 物料编码 + 物料名称
  - **标签**: 版本号 (Tag), 状态 (Badge)
  - **属性**: 用量、单位、生效日期 (图标 + 文字)
- **操作**: 节点右侧悬浮显示操作按钮组（查看、复制、反查该节点）。

#### B. 列表视图 (Table View)
- **适用场景**: 数据量大、需要排序或批量处理时。
- **特性**:
  - 支持列宽拖拽。
  - 支持按“层级”、“用量”、“日期”排序。
  - 行高亮：鼠标悬停时整行背景变色。

### 4. 状态反馈 (Feedback)
- **加载中**: 使用 Lottie 动画（如旋转的齿轮或搜索放大镜）。
- **无数据**: 精美的 SVG 插画，配文“未找到相关引用关系”。
- **错误**: 顶部 Alert 提示，红色背景，带重试按钮。

---

## 📱 响应式适配策略

### Mobile (< 768px)
- **布局调整**: 
  - 隐藏左侧概览栏，改为顶部横向滚动卡片。
  - 搜索栏缩小，置顶固定。
- **视图调整**:
  - 强制使用 **卡片流视图** (Card Stream)，不显示复杂的树状线。
  - 每个结果作为一个独立卡片，点击进入详情页。

### Tablet (768px - 1024px)
- **布局调整**:
  - 侧边栏折叠为图标模式。
  - 树状视图保持，但隐藏次要信息列。

---

## 🛠 技术实现建议

### 前端技术栈
- **框架**: Vue 3 + TypeScript
- **UI库**: Element Plus / Ant Design Vue (定制主题)
- **图表库**: ECharts (用于未来扩展关系图谱)
- **工具库**: Lodash (防抖/节流), Day.js (日期处理)

### 关键组件API
```typescript
// BomTreeItem 组件 Props
interface BomTreeItemProps {
  data: BomReverseLookupDto;
  level: number;
  expanded: boolean;
  onToggle: () => void;
  onDetail: (id: string) => void;
}

// SearchBar 组件 Props
interface SearchBarProps {
  loading: boolean;
  onSearch: (query: string) => void;
  suggestions: string[];
}
```

---

## 📝 验收清单 (Checklist)

1.  **视觉还原**: 是否符合定义的色彩和字体规范？
2.  **交互完整**: 搜索、展开、折叠、跳转是否流畅？
3.  **异常处理**: 网络断开、无权限、数据为空时是否有正确提示？
4.  **性能达标**: 1000条数据渲染是否卡顿？（目标 < 1s）
5.  **移动端适配**: 手机上是否能完成核心查询流程？

---

**文档编制**: AI Assistant (Antigravity)
**审核人**: 产品经理 / UI设计师
**最后更新**: 2025-11-23
