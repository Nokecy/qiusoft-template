# 检验执行界面线框图文档

## 文档概述

本文档基于对检验执行模块代码的深度分析，详细描述了渐进式检验执行系统的界面布局、组件结构和用户交互设计。

**分析范围**：
- 主模块：`src/pages/appQms/inspectionOrders/execute/progressive/`
- 关键组件：ProgressiveExecution, CurrentProjectCard, ProjectNavigation
- 支持组件：InspectionValuesDisplay, DefectsListDisplay, InspectionValuesDialog

## 1. PC端主界面线框图

### 1.1 整体布局（Layout）

```
┌─────────────────────────────────────────────────────────────────────┐
│                        检验执行系统 - 渐进式检验                          │
├─────────────────────┬───────────────────────────────────────────────┤
│    项目导航侧边栏      │                  主内容区域                     │
│   ┌─────────────┐   │  ┌─────────────────────────────────────────┐  │
│   │ 检验进度     │   │  │        检验单摘要信息卡片                │  │
│   │ [████████▒▒] │   │  │  检验单号: IOS-2024-001                 │  │
│   │ 8/10 (80%)  │   │  │  物料: 电容器 | 规格: 10μF/25V         │  │
│   └─────────────┘   │  │  执行进度: 8/10 已完成                   │  │
│   ┌─────────────┐   │  └─────────────────────────────────────────┘  │
│   │ 状态统计     │   │                                               │
│   │ ✅ 8 已完成  │   │  ┌─────────────────────────────────────────┐  │
│   │ ⏳ 2 待检验  │   │  │          当前检验项目卡片                │  │
│   │ ❌ 0 不合格  │   │  │                                         │  │
│   └─────────────┘   │  │  ┌─────────────┬─────────────────────┐  │  │
│                     │  │  │ 左侧信息区   │    右侧操作区         │  │  │
│   ┌─────────────┐   │  │  │             │                     │  │  │
│   │ 项目列表     │   │  │  │ 📋 检验规格  │  🎯 检验结果选择      │  │  │
│   │             │   │  │  │ • 方法: 目测 │  ○ 待检验            │  │  │
│   │ ✅ #1 外观   │   │  │  │ • 设备: -   │  ○ 合格 ○ 不合格     │  │  │
│   │ ✅ #2 尺寸   │   │  │  │ • 检验员:-   │                     │  │  │
│   │ ⏳ #3 功能 ← │   │  │  │             │  📝 备注填写         │  │  │
│   │ ⏳ #4 性能   │   │  │  │ 📊 检验值记录│  ┌─────────────────┐  │  │
│   │ ⏳ #5 耐压   │   │  │  │ • 值1: 9.8μF │  │                 │  │  │
│   │             │   │  │  │ • 值2: 10.1μF│  │                 │  │  │
│   │             │   │  │  │ [录入检验值]  │  │                 │  │  │
│   │             │   │  │  │             │  └─────────────────┘  │  │
│   │             │   │  │  │ 🚨 缺陷信息  │                     │  │  │
│   │             │   │  │  │ (无缺陷)     │  [重置] [提交并下一项] │  │  │
│   │             │   │  │  │ [录入缺陷]   │                     │  │  │
│   └─────────────┘   │  │  └─────────────┴─────────────────────┘  │  │
│                     │  └─────────────────────────────────────────┘  │
│                     │                                               │
│                     │  ┌─────────────────────────────────────────┐  │
│                     │  │              底部操作栏                  │  │
│                     │  │ [← 上一项]  [保存草稿] [返回列表] [下一项 →] │  │
│                     │  └─────────────────────────────────────────┘  │
├─────────────────────┴───────────────────────────────────────────────┤
│                           状态栏                                    │
└─────────────────────────────────────────────────────────────────────┘
```

### 1.2 侧边栏详细设计（ProjectNavigation）

```
┌─────────────────────────┐
│      项目导航侧边栏        │
├─────────────────────────┤
│ 🎯 检验进度               │
│ ████████████▒▒▒▒ 80%    │
│ 8/10 项目完成             │
│                         │
│ 📊 状态统计               │
│ ✅ 已完成: 8             │
│ ⏳ 待检验: 2             │
│ ❌ 不合格: 0             │
│ 🚨 缺陷: 0               │
├─────────────────────────┤
│ 📋 检验项目列表           │
│                         │
│ ✅ #1 外观检验           │
│ │  外观检验项目           │
│ │  [已完成 2024-01-15]   │
│                         │
│ ✅ #2 尺寸测量           │
│ │  尺寸规格检验           │
│ │  [已完成 2024-01-15]   │
│                         │
│ 🔵 #3 功能测试 [当前]     │
│ │  功能性能测试           │
│ │  [进行中...]          │
│                         │
│ ⏳ #4 电气性能           │
│ │  电气参数测试           │
│ │  [待检验]              │
│                         │
│ ⏳ #5 耐压测试           │
│ │  耐压安全测试           │
│ │  [待检验]              │
└─────────────────────────┘
```

### 1.3 当前项目卡片详细设计（CurrentProjectCard）

```
┌─────────────────────────────────────────────────────────────────┐
│                    当前检验项目：功能测试                         │
│  项目编号: FUNC-001  |  序号: #3  |  状态: 🔵 待检验            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ ┌───────────────────────────────┬─────────────────────────────┐ │
│ │          左侧信息展示区         │        右侧操作表单区        │ │
│ │                               │                             │ │
│ │ 📋 检验规格                   │ ⚠️ 待检验                   │ │
│ │ ┌─────────────────────────┐   │ 请按照检验要求完成检验       │ │
│ │ │ 检验方法: 功能性能测试    │   │ 并录入结果                  │ │
│ │ │ 检验设备: 功能测试仪      │   │                             │ │
│ │ │ 检验员: 张三             │   │ 🎯 检验结果                 │ │
│ │ └─────────────────────────┘   │ ○ 待检验                    │ │
│ │                               │ ○ 合格   ○ 不合格          │ │
│ │ ℹ️ 检验要点                   │                             │ │
│ │ 检查功能是否正常，参数       │ 📝 检验备注                 │ │
│ │ 是否符合规范要求             │ ┌─────────────────────────┐ │ │
│ │                               │ │                         │ │ │
│ │ 📊 检验值记录                 │ │ 请填写检验备注...        │ │ │
│ │ ┌─────────────────────────┐   │ │                         │ │ │
│ │ │ 此检验项需要录入测量值   │   │ └─────────────────────────┘ │ │
│ │ │ 📊 点击"录入"按钮添加    │   │                             │ │
│ │ │    测量数据              │   │ ─────────────────────────── │ │
│ │ │                         │   │                             │ │
│ │ │     [录入检验值]         │   │ [重置]     [提交并下一项]    │ │
│ │ └─────────────────────────┘   │                             │ │
│ │                               │                             │ │
│ │ 🚨 缺陷信息                   │                             │ │
│ │ ┌─────────────────────────┐   │                             │ │
│ │ │ 检验结果为不合格时需要   │   │                             │ │
│ │ │ 录入缺陷信息             │   │                             │ │
│ │ │                         │   │                             │ │
│ │ │     [录入缺陷]           │   │                             │ │
│ │ └─────────────────────────┘   │                             │ │
│ └───────────────────────────────┴─────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

## 2. 移动端界面线框图

### 2.1 移动端主界面

```
┌─────────────────────────┐
│ ☰ 项目列表  功能测试  ⏮ ⏭ │ ← 顶部工具栏
│        3/10              │
├─────────────────────────┤
│ 📋 检验单摘要             │
│ IOS-2024-001            │
│ 电容器 | 10μF/25V       │
│ 进度: 8/10 (80%)        │
├─────────────────────────┤
│                         │
│ 🎯 当前项目: 功能测试      │
│ 项目编号: FUNC-001       │
│ 状态: 🔵 待检验          │
│                         │
│ 📋 检验规格               │
│ 方法: 功能性能测试        │
│ 设备: 功能测试仪         │
│                         │
│ 📊 检验值记录             │
│ [录入检验值]             │
│                         │
│ 🎯 检验结果               │
│ ○ 待检验                │
│ ○ 合格  ○ 不合格        │
│                         │
│ 📝 检验备注               │
│ ┌─────────────────────┐ │
│ │                     │ │
│ └─────────────────────┘ │
│                         │
│ [重置]    [提交并下一项]   │
│                         │
│                         │
│                         │
│                         │
└─────────────────────────┘
                   [🏠] ← 浮动按钮
                  [⏮][⏭]   (返回/导航)
```

### 2.2 移动端抽屉式侧边栏

```
┌─────────────────────────┐
│ 📋 检验项目 (8/10)       │ ← 抽屉标题
├─────────────────────────┤
│ 🎯 检验进度               │
│ ████████▒▒ 80%          │
│                         │
│ ✅8 ⏳2 ❌0 🚨0         │
├─────────────────────────┤
│ ✅ #1 外观检验           │
│   已完成 01-15 10:30    │
│                         │
│ ✅ #2 尺寸测量           │
│   已完成 01-15 10:45    │
│                         │
│ 🔵 #3 功能测试          │
│   进行中... [当前]       │
│                         │
│ ⏳ #4 电气性能           │
│   待检验                │
│                         │
│ ⏳ #5 耐压测试           │
│   待检验                │
│                         │
│                         │
│                         │
│                         │
│               [关闭]     │
└─────────────────────────┘
```

## 3. 关键交互组件线框图

### 3.1 检验值录入弹框（InspectionValuesDialog）

```
┌─────────────────────────────────────────────────────────────┐
│               检验值录入 - 功能测试                          │
│                                                    [✕]      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 📋 检验标准                                                  │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 项目: 功能测试 (FUNC-001)                                │ │
│ │ 标准范围: 9.0 ~ 11.0 μF                                 │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 📊 测量值记录                                                │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ ⚙️ #1  [9.8    ] μF  [备注...]              [🗑️]       │ │
│ │ ⚙️ #2  [10.1   ] μF  [备注...]              [🗑️]       │ │
│ │ ⚙️ #3  [9.9    ] μF  [在规范范围内]          [🗑️]       │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ [+ 添加测量值]                                               │
│                                                             │
│                                    [取消]      [确定]       │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 缺陷录入弹框（DefectDialog）

```
┌─────────────────────────────────────────────────────────────┐
│                   缺陷信息录入                               │
│                                                    [✕]      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 📋 项目信息: 功能测试 | 样本数量: 1                          │
│                                                             │
│ 🚨 缺陷记录                                                  │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 缺陷编码: [D001          ▼]  缺陷名称: 功能异常           │ │
│ │ 缺陷位置: [输入位置...]                                   │ │
│ │ 缺陷数量: [1]                                            │ │
│ │ 严重程度: ○ 轻微  ●● 重要  ○ 致命                       │ │
│ │ 缺陷描述: ┌─────────────────────────────────────────┐    │ │
│ │          │ 功能测试时发现参数超出规范范围...        │    │ │
│ │          └─────────────────────────────────────────┘    │ │
│ │                                                [删除]     │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ [+ 添加缺陷]                                                 │
│                                                             │
│                                    [取消]      [确定]       │
└─────────────────────────────────────────────────────────────┘
```

## 4. 界面状态变化示意

### 4.1 项目状态流转

```
┌─────────────┐  录入检验值  ┌─────────────┐  选择结果  ┌─────────────┐
│ ⏳ 待检验    │ ─────────→  │ 📊 数据录入   │ ────────→  │ ✅ 检验完成  │
│             │             │ 中...        │           │             │
│ • 空白表单   │             │ • 有测量值    │           │ • 结果确定   │
│ • 等待录入   │             │ • 可选择结果  │           │ • 自动跳转   │
└─────────────┘             └─────────────┘           └─────────────┘
                                   ↓
                            ┌─────────────┐
                            │ 🚨 录入缺陷   │ (如果不合格)
                            │             │
                            │ • 缺陷对话框  │
                            │ • 强制录入   │
                            └─────────────┘
```

### 4.2 进度更新流程

```
项目完成 ─→ 状态更新 ─→ 进度刷新 ─→ 自动跳转
    │          │          │          │
    ✅         📊         🔄         ⏭️
 完成标记    统计更新    进度条更新   下一项目
```

## 5. 设计原则和规范

### 5.1 响应式设计
- **PC端**: 双栏布局，充分利用宽屏空间
- **移动端**: 单栏布局，抽屉式导航，浮动操作按钮
- **断点**: `md: 768px` 以下切换为移动端模式

### 5.2 交互设计原则
- **渐进式披露**: 按需显示信息，避免界面过载
- **状态反馈**: 及时反馈操作结果和系统状态
- **一致性**: 统一的图标、颜色、交互模式
- **容错性**: 防误操作，支持撤销和重置

### 5.3 视觉层次
- **主要操作**: 突出显示，使用主色调按钮
- **次要操作**: 次要按钮或链接形式
- **状态指示**: 统一的图标和颜色系统
- **信息展示**: 清晰的分组和对比度

### 5.4 颜色规范
- **成功**: `#52c41a` (绿色) - 已完成、合格
- **警告**: `#faad14` (橙色) - 待处理、进行中
- **错误**: `#ff4d4f` (红色) - 不合格、错误
- **信息**: `#1890ff` (蓝色) - 一般信息、链接
- **中性**: `#8c8c8c` (灰色) - 次要信息

## 6. 技术实现要点

### 6.1 组件架构
- **主容器**: `ProgressiveExecution` (Layout + 状态管理)
- **导航组件**: `ProjectNavigation` (项目列表 + 进度显示)  
- **执行组件**: `CurrentProjectCard` (检验操作 + 表单管理)
- **辅助组件**: `InspectionValuesDisplay`, `DefectsListDisplay`
- **弹框组件**: `InspectionValuesDialog`, `DefectDialog`

### 6.2 状态管理
- **React.useState**: 组件本地状态 (currentIndex, loading)
- **Formily**: 表单状态管理 (检验结果、测量值、缺陷)
- **API调用**: 数据同步 (项目信息、执行结果)
- **localStorage**: 草稿保存 (可选功能)

### 6.3 性能优化
- **虚拟滚动**: 大量项目列表优化
- **懒加载**: 图片和非关键内容延迟加载  
- **缓存机制**: API结果缓存和防重复请求
- **防抖节流**: 输入框和按钮操作优化

---

**文档版本**: 1.0  
**创建时间**: 2024-08-29  
**基于代码版本**: 当前最新版本  
**维护人员**: Claude Code Assistant